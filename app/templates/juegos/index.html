{% extends "base.html" %}
{% block contenido %}
<section class="pantalla-movil">
    <div class="juegos-header">
        <button class="btn-volver" onclick="volverAtras()">‚Üê Volver</button>
        <h1 class="titulo-rojo centrado" style="margin:0;font-size:1.3rem;">üéÆ Juegos Fonoaudiol√≥gicos</h1>
        <div style="width:80px;"></div>
    </div>
    <p class="centrado texto-peque√±o" style="margin-bottom:1.5rem;margin-top:0.5rem;">Selecciona una categor√≠a para comenzar a practicar</p>

    <div class="juegos-grid">
        <a href="/juegos/practica" class="juego-card practica" onclick="guardarOrigen()">
            <div class="juego-icono">üß©</div>
            <div class="juego-info"><h2>Practica Conmigo</h2><p>Rompecabezas, crea tu personaje y asocia im√°genes</p></div>
            <span class="juego-flecha">‚Ä∫</span>
        </a>
        <a href="/juegos/respiracion" class="juego-card respiracion" onclick="guardarOrigen()">
            <div class="juego-icono">üéà</div>
            <div class="juego-info"><h2>Respiraci√≥n</h2><p>Practica la respiraci√≥n diafragm√°tica correcta</p></div>
            <span class="juego-flecha">‚Ä∫</span>
        </a>
        <a href="/juegos/fonacion" class="juego-card fonacion" onclick="guardarOrigen()">
            <div class="juego-icono">üéµ</div>
            <div class="juego-info"><h2>Fonaci√≥n</h2><p>Ejercicios de voz: goles y escalas musicales</p></div>
            <span class="juego-flecha">‚Ä∫</span>
        </a>
        <a href="/juegos/resonancia" class="juego-card resonancia" onclick="guardarOrigen()">
            <div class="juego-icono">üéπ</div>
            <div class="juego-info"><h2>Resonancia</h2><p>Escaleras de tono y piano interactivo</p></div>
            <span class="juego-flecha">‚Ä∫</span>
        </a>
        <a href="/juegos/articulacion" class="juego-card articulacion" onclick="guardarOrigen()">
            <div class="juego-icono">üó£Ô∏è</div>
            <div class="juego-info"><h2>Articulaci√≥n</h2><p>Aprende a pronunciar letras correctamente</p></div>
            <span class="juego-flecha">‚Ä∫</span>
        </a>
        <a href="/juegos/prosodia" class="juego-card prosodia" onclick="guardarOrigen()">
            <div class="juego-icono">üé§</div>
            <div class="juego-info"><h2>Prosodia</h2><p>Trabalenguas, adivinanzas y canciones</p></div>
            <span class="juego-flecha">‚Ä∫</span>
        </a>
        <a href="/juegos/discriminacion" class="juego-card discriminacion" onclick="guardarOrigen()">
            <div class="juego-icono">üëÇ</div>
            <div class="juego-info"><h2>Discriminaci√≥n Auditiva</h2><p>Escucha y reconoce sonidos de animales y objetos</p></div>
            <span class="juego-flecha">‚Ä∫</span>
        </a>
    </div>
</section>

<style>
.juegos-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:0.5rem; padding-bottom:0.8rem; border-bottom:1px solid #f0f0f0; }
.btn-volver { background:none; border:1px solid #d32f2f; color:#d32f2f; border-radius:20px; padding:0.35rem 0.9rem; font-size:0.85rem; cursor:pointer; font-weight:600; transition:background 0.15s; white-space:nowrap; }
.btn-volver:hover { background:#fff5f5; }
.juegos-grid { display:flex; flex-direction:column; gap:0.9rem; }
.juego-card { display:flex; align-items:center; gap:1rem; padding:1rem 1.2rem; border-radius:14px; text-decoration:none; color:#333; transition:transform 0.15s, box-shadow 0.15s; box-shadow:0 2px 8px rgba(0,0,0,0.07); }
.juego-card:hover { transform:translateY(-2px); box-shadow:0 6px 18px rgba(0,0,0,0.12); }
.juego-card.practica    { background:linear-gradient(135deg,#fff7f7,#ffe0e0); border-left:4px solid #d32f2f; }
.juego-card.respiracion { background:linear-gradient(135deg,#f0f8ff,#d0eaff); border-left:4px solid #1976d2; }
.juego-card.fonacion    { background:linear-gradient(135deg,#f5fff0,#d4f5c0); border-left:4px solid #388e3c; }
.juego-card.resonancia  { background:linear-gradient(135deg,#fffbf0,#ffe9a0); border-left:4px solid #f57c00; }
.juego-card.articulacion{ background:linear-gradient(135deg,#fff0f8,#ffd6ee); border-left:4px solid #e63946; }
.juego-card.prosodia    { background:linear-gradient(135deg,#f3e5f5,#e1bee7); border-left:4px solid #7b1fa2; }
.juego-card.discriminacion { background:linear-gradient(135deg,#e0f7fa,#b2ebf2); border-left:4px solid #00838f; }
.juego-icono { font-size:2.4rem; min-width:3rem; text-align:center; }
.juego-info h2 { margin:0 0 0.2rem; font-size:1rem; color:#222; font-weight:700; }
.juego-info p  { margin:0; font-size:0.8rem; color:#666; }
.juego-flecha  { font-size:1.4rem; color:#bbb; margin-left:auto; padding-left:0.5rem; }
</style>

<script>
// Guardar el origen cuando se entra al hub de juegos
(function() {
    // Si venimos de admin, doctor o paciente, guardar en sessionStorage
    const ref = document.referrer;
    if (ref.includes('/admin/')) {
        sessionStorage.setItem('juegos_origen', '/admin/dashboard');
    } else if (ref.includes('/doctor/')) {
        sessionStorage.setItem('juegos_origen', '/doctor/home');
    } else if (ref.includes('/paciente/')) {
        sessionStorage.setItem('juegos_origen', '/paciente/perfil');
    }
    // Si ya hay un origen guardado, no lo sobreescribir (para cuando navegamos entre categor√≠as)
})();

function guardarOrigen() {
    // Mantener el origen cuando navegamos a una categor√≠a
    // (no hacer nada, el origen ya est√° guardado)
}

function volverAtras() {
    const origen = sessionStorage.getItem('juegos_origen');
    if (origen) {
        window.location.href = origen;
    } else {
        // Fallback: intentar con referrer o ir a paciente
        const ref = document.referrer;
        if (ref && !ref.includes('/juegos/')) {
            window.location.href = ref;
        } else {
            window.location.href = '/paciente/perfil';
        }
    }
}
</script>
{% endblock %}
